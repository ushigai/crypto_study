# Hastad Broadcast Attack
## 概要
同一の平文$M$を$k$人に対して送る例を考えます。このとき、$i$番目の人の暗号文$C_i$は以下の様に計算できます。

$$C_i = M^e \mod N_i$$

ここで仮に$e=3$と置いたとき、

$$
C∊Z^{*}_{N_1N_2N_3} \\
$$

となり、また平文$M$より$N$のほうが常に大きいことからCRTを用いて、
$$
C≡M^3 \mod N_1N_2N_3 \\
C=M^3
$$
がわかります。

このように平文をそのままブロードキャストする例だとCRTによって簡単に復号できそうな気がします。しかし、

$$
M_i=a_i・M + b_i \\
C_i = M_i^e \mod N_i
$$

のように線形パディングをした場合はそのままCRTを適合することはできません。ここで役に立つのがCopperSmith's Methodです。

## 攻撃
$$
M_i=a_i・M + b_i \\
C_i = M_i^e \mod N_i
$$
の線形パディングでのCopperSmith's Method適応方法について考えてみます。
まずCRTで全ての$j$に対して$T_i=1 \mod N_i$で、$T_i=0 \mod N_{i≠j}$となるような$T_i$を求め、多項式環$g_i(x)$を以下の様に定めます。

$$
g_i(x)= \sum_{i=1}^{e} T_i・((a_i・M+b_i)^e-C_i)
$$

ここで全ての$i$に対して$T_j=0 \mod n_i (i≠j)$または$(a_i・M+b_i)^5=c_i \mod n_i$が成り立つので、$g(m) \mod n_i=0$となります。

この仮定のもと、全ての$i$に対して$(N_i, g_i)$の組が得られれば効率的に$M$を復号することができます。


## 条件
係数$T_i$を求めるのにCRTを使うのでまず$e$個以上の$(N_i, g_i)$の組が分かっている必要があり、またパディング方法は線形である必要があります。ランダムパディングについては有効な攻撃方法とはなりえません。

